<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>IS REAL COFFEE â€” Bullet Hell</title>
<style>
  body { margin:0; overflow:hidden; background:black; }
  #mainMenu {
    position:absolute; inset:0;
    display:flex; flex-direction:column;
    justify-content:center; align-items:center;
    background:black; color:white;
    font-family:Arial; z-index:10;
  }
  button {
    padding:15px 30px; font-size:20px;
    cursor:pointer; border:none;
    background:#444; color:white;
  }
</style>
</head>
<body>
<div id="mainMenu">
  <h1>I AM IS REAL COFFEE PT BOME GAH ZAH</h1>
  <button id="startBtn">START</button>
</div>
<canvas id="gameCanvas" width="900" height="600"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// --- Images ---
const playerImg = new Image(); playerImg.src = "player.png";
const bossImg   = new Image(); bossImg.src   = "boss.png";
const gubbyImg  = new Image(); gubbyImg.src  = "gubby.png";

// --- Player ---
const player = {
  x:100, y:300, width:40, height:50,
  vx:0, vy:0,
  speed:4,
  jumpPower:15,
  onGround:false,
  attacking:false
};

// --- Input ---
const keys = {};
document.addEventListener("keydown", e => keys[e.key]=true);
document.addEventListener("keyup", e => keys[e.key]=false);
canvas.addEventListener("mousedown", ()=> player.attacking=true);
canvas.addEventListener("mouseup", ()=> player.attacking=false);

// --- Platforms ---
const platforms = [
  {x:0, y:560, width:900, height:40},
  {x:150, y:420, width:200, height:20},
  {x:450, y:380, width:220, height:20},
  {x:250, y:300, width:180, height:20},
  {x:500, y:240, width:200, height:20},
  {x:100, y:200, width:180, height:20},
  {x:350, y:150, width:240, height:20}
];

// --- Boss ---
let boss = {
  x:600, y:200, width:120, height:120,
  hp:300,
  phase:1,
  attackTimer:0,
  laserTimer:0,
  red:false
};

// --- Bullets, Minions ---
let bullets = [];
let minions = [];

function shootAtPlayer(speed){
  const angle = Math.atan2(player.y - boss.y, player.x - boss.x);
  bullets.push({
    x: boss.x, y: boss.y,
    vx: Math.cos(angle)*speed,
    vy: Math.sin(angle)*speed,
    r:8
  });
}

function spawnMinion(){
  minions.push({ x: boss.x, y: boss.y+50, vx: (Math.random()<0.5?-2:2), vy:0, size:40 });
}

function bossUpdate(){
  if(boss.hp <= 150 && boss.phase === 1){
    boss.phase = 2;
    boss.red = true;
  }

  boss.attackTimer++;

  if(boss.phase === 1){
    if(boss.attackTimer % 60 === 0) shootAtPlayer(4);
    if(boss.attackTimer % 120 === 0){ boss.laserTimer = 90; }
  }

  else if(boss.phase === 2){
    if(boss.attackTimer % 40 === 0) shootAtPlayer(6);
    if(boss.attackTimer % 150 === 0) spawnMinion();
    if(boss.attackTimer % 200 === 0) spawnMinion();
    if(boss.attackTimer % 120 === 0){ boss.laserTimer = 120; }
  }

  if(boss.laserTimer > 0){ boss.laserTimer--; }
}

function drawLaser(){
  if(boss.laserTimer > 0){
    ctx.fillStyle = "red";
    ctx.fillRect(boss.x+boss.width/2, boss.y+boss.height/2 - 5, 900, 10);
    if(player.x > boss.x && player.y > boss.y && player.y < boss.y+boss.height){ die(); }
  }
}

// --- Physics ---
function updatePlayer(){
  player.vx = 0;
  if(keys["a"]) player.vx = -player.speed;
  if(keys["d"]) player.vx = player.speed;
  if(keys["w"] && player.onGround){ player.vy = -player.jumpPower; player.onGround=false; }

  player.vy += 0.9;
  player.x += player.vx;
  player.y += player.vy;

  player.onGround = false;
  for(const p of platforms){
    if(player.x < p.x+p.width && player.x+player.width > p.x &&
       player.y+player.height < p.y+20 && player.y+player.height > p.y){
      player.y = p.y - player.height;
      player.vy = 0;
      player.onGround = true;
    }
  }
}

// --- Update bullets/minions ---
function updateEnemies(){
  for(const b of bullets){ b.x += b.vx; b.y += b.vy; }
  bullets = bullets.filter(b => b.x>-50 && b.x<950 && b.y>-50 && b.y<650);

  for(const m of minions){
    m.x += m.vx;
    m.vy += 0.4;
    m.y += m.vy;

    for(const p of platforms){
      if(m.x < p.x+p.width && m.x+m.size > p.x && m.y+m.size < p.y+20 && m.y+m.size > p.y){
        m.y = p.y - m.size;
        m.vy = 0;
      }
    }

    if(Math.abs(m.x - player.x) < 40 && Math.abs(m.y - player.y) < 40) die();
  }
}

// --- Collision for sword ---
function swordHit(){
  if(player.attacking){
    const reach = { x: player.x+player.width, y: player.y, w:40, h:40 };
    if(reach.x < boss.x+boss.width && reach.x+reach.w > boss.x && reach.y < boss.y+boss.height && reach.y+reach.h > boss.y){
      boss.hp -= 2;
    }
  }
}

// --- Death ---
function die(){ location.reload(); }

// --- Draw ---
function draw(){
  ctx.clearRect(0,0,900,600);

  ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);

  ctx.save();
  if(boss.red) ctx.filter="hue-rotate(180deg)";
  ctx.drawImage(bossImg, boss.x, boss.y, boss.width, boss.height);
  ctx.restore();

  for(const p of platforms){
    ctx.fillStyle="#555";
    ctx.fillRect(p.x,p.y,p.width,p.height);
  }

  for(const b of bullets){
    ctx.fillStyle="yellow";
    ctx.beginPath(); ctx.arc(b.x,b.y,b.r,0,Math.PI*2); ctx.fill();
  }

  for(const m of minions){ ctx.drawImage(gubbyImg,m.x,m.y,m.size,m.size); }

  drawLaser();

  ctx.fillStyle="white";
  ctx.fillText("HP: "+boss.hp,20,30);
}

function gameLoop(){
  updatePlayer();
  updateEnemies();
  bossUpdate();
  swordHit();
  draw();
  requestAnimationFrame(gameLoop);
}

// --- Start Button ---
document.getElementById("startBtn").onclick = () => {
  document.getElementById("mainMenu").style.display = "none";
  canvas.focus();
  gameLoop();
};
</script>
</body>
</html>
